<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Sortable + Svelte + Tauri: Getting a sortable list right in a cross-platform app | Nibbles and Bytes</title><meta name=keywords content="Tauri,Svelte"><meta name=description content="AI might be better than a rubber duck"><meta name=author content="Lyndon Shi"><link rel=canonical href=https://lynshi.github.io/posts/sortable_svelte_and_tauri/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://lynshi.github.io/favicon/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://lynshi.github.io/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://lynshi.github.io/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://lynshi.github.io/favicon/apple-touch-icon.png><link rel=mask-icon href=https://lynshi.github.io/favicon/favicon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})'></script><meta property="og:title" content="Sortable + Svelte + Tauri: Getting a sortable list right in a cross-platform app"><meta property="og:description" content="AI might be better than a rubber duck"><meta property="og:type" content="article"><meta property="og:url" content="https://lynshi.github.io/posts/sortable_svelte_and_tauri/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-17T19:04:10-08:00"><meta property="article:modified_time" content="2026-01-17T19:04:10-08:00"><meta property="og:site_name" content="Nibbles and Bytes"><meta name=twitter:card content="summary"><meta name=twitter:title content="Sortable + Svelte + Tauri: Getting a sortable list right in a cross-platform app"><meta name=twitter:description content="AI might be better than a rubber duck"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://lynshi.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Sortable + Svelte + Tauri: Getting a sortable list right in a cross-platform app","item":"https://lynshi.github.io/posts/sortable_svelte_and_tauri/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Sortable + Svelte + Tauri: Getting a sortable list right in a cross-platform app","name":"Sortable \u002b Svelte \u002b Tauri: Getting a sortable list right in a cross-platform app","description":"AI might be better than a rubber duck","keywords":["Tauri","Svelte"],"articleBody":"Sortable is a very nice JavaScript library for making HTML lists sortable via drag-and-drop, and it‚Äôs got a very clear and easy to use API. Unfortunately, I spent a very long time struggling to integrate it into my app, so now that I‚Äôve figured it out I might as well collect my findings into the blog post I wish I could have referenced instead.\nIt was quite hard to get working for two reasons. First, I‚Äôm using Svelte (version 5), which is a UI framework that very much wants to solely manage the HTML. Second, I‚Äôm using Tauri (version 2.0), a framework for building cross-platform applications; this adds complexity beyond a web app.\nBefore getting started, I searched for resources that would tell me exactly how to integrate all three things together. Sadly, there were none. The closest I got, and what I started with, was this ‚ÄúSvelte 5 and SortableJS‚Äù blog post. Unfortunately, there were still several issues to iron out thanks to the Tauri variable. Ultimately, I ended up with an attachment-based solution for an even more ~modern~ Svelte flavor1.\nWriting the attachment The attachment itself is very simple. I created a function that takes Sortable options and returns an attachment that creates a Sortable with the provided options.\nimport Sortable from \"sortablejs\"; import type { Attachment } from \"svelte/attachments\"; export const sortableList = (options: Sortable.Options): Attachment =\u003e { return (element: Element) =\u003e { const sortable = Sortable.create(element as HTMLElement, options); return () =\u003e { sortable.destroy(); }; }; }; Similarily to the ‚ÄúSvelte 5 and SortableJS‚Äù blog post, I provided a helper function for reordering, though I chose to return null if the order remained the same to avoid unnecessary updates.\nexport function reorder\u003cT\u003e( array: T[], evt: Sortable.SortableEvent, ): T[] | null { const newArray = [...$state.snapshot(array)] as T[]; const { oldIndex, newIndex } = evt; if (oldIndex === undefined || newIndex === undefined) { return null; } if (newIndex === oldIndex) { return null; } const target = newArray[oldIndex]; const increment = newIndex \u003c oldIndex ? -1 : 1; for (let k = oldIndex; k !== newIndex; k += increment) { newArray[k] = newArray[k + increment]; } newArray[newIndex] = target; return newArray; } The exact parameters in your Sortable options will vary, but the most important bit is to actually reorder your items!\nimport { reorder } from \"$lib/sortable.svelte\"; const sortableOptions = { onUpdate(event: any) { const newList = reorder(groups, event); if (newList == null) { return; } // Placeholder for updating the order of items. updateOrdering(newList); } } Then, we need to create the list and attach sortableList. You can generate list items dynamically with @each, but I found that it‚Äôs crucial to wrap the list in a #key block to recreate the list and Sortable every time the items are reordered. If you do not do this, the item ordering will get out of sync between Svelte and Sortable and your list will not display in the correct order.\n\u003cscript\u003e import { sortableList } from \"$lib/sortable.svelte\"; // Your list of things const items = [ { id: \"item-id\", text: \"item-text\", } ]; \u003c/script\u003e {#key items} \u003cul {@attach sortableList(sortableOptions)}\u003e {#each items as item (item.id)} \u003cli\u003e{item.text}\u003c/li\u003e {/each} \u003c/ul\u003e {/key} Making drag and drop work From the Svelte side, everything looks great now. In fact, it will work perfectly if you throw it in a REPL2, which is maddening because locally, in your Tauri app, you will not be able to drag any list items!\nThis is the first Tauri-introduced issue I encountered. The application window‚Äôs drag-and-drop functionality was preventing the drag-and-drop event from registering in the webview. To avoid this, I had to add dragDropEnabled: false to my tauri.conf.json:\n{ \"app\": { \"windows\": [ { \"dragDropEnabled\": false } ], } } Many thanks to this Reddit post for providing the hint I needed to find this fix!\nAI to the rescue At this point, I had a working sortable list with one big problem. While I could drag one item to reorder it, I could not consistently reorder items consecutively. The vast majority of the time, after moving one item I would have to click anywhere else on the page to be able to move another item. If I did not click elsewhere, clicking a sortable item would not start a drag event, and I would end up highlighting the text instead.\nAnd yes, ‚Äúvast majority of the time‚Äù means that on occassion I would be able to reorder items consecutively. So at first glance, this looks like a race condition along the lines of the list being rendered before the sortable functionality is available. However, that hypothesis is somewhat invalidated by the fact that when you are unable to reorder items consecutively, you cannot move the second item no matter how long you wait after moving the first item.\nIn any event, I did the obvious thing which is to add a bunch of print statements and then try various things to ascertain the order of events. When that failed, I had a few more hypotheses, but with my limited JavaScript knowledge I didn‚Äôt know how to test them out.\nEnter AI. At work, I‚Äôm a pretty big fan of Claude Code because it doesn‚Äôt interrupt my stream of thought by injecting slop when I hit Tab to, literally, insert spaces. However, it‚Äôs a lot easier to use a tool when you don‚Äôt have to pay for it! Luckily, Sourcegraph makes a similar terminal-based agent that has a free, ad-supported mode: Amp. The ads are not bothersome at all and the agent worked quite well. With Amp, I was able to iterate quickly on my hypotheses.\nThe most promising hypothesis I had was that dragging the first item hijacked pointer events in a way that required a ‚Äúreset‚Äù (i.e. by clicking elsewhere). I tried a few related fixes, such as injecting pointerup events after destroying the Sortable, to no avail. Along the way, Amp suggested various code changes, one of which led to me printing event.originalEvent from the event received by onUpdate.\nI noticed that the original event is actually a DragEvent. I‚Äôm no frontend developer, but this seems a little different from a pointer-based event. I responded to Amp with this:\nDispatching pointerup doesn‚Äôt help. Even though it‚Äôs logged, I still need to click again to reactivate the sortable. I also noticed that event.originalEvent is a dragEvent with preventDefault: true.\nWith that, it produced an interesting code block:\nconst sortable = Sortable.create(el, { ...options, forceFallback: true, // Force pointer events instead of drag events }); From Sortable docs, forceFallback changes how drag-and-drop works to be compatible with non-HTML5 browsers, even on HTML5 browsers. Setting this option completely fixes the issue!\nUnfortunately, what I can‚Äôt tell you is why this works, and after bashing my head on this for far too long I lack the inclination to do further research. Amp reported that ‚ÄúHTML5 Drag and Drop has known quirks, especially in Electron-like environments like Tauri‚Äù, but when pressed to cite sources it deflected with ‚ÄúI was making educated guesses based on the symptoms you showed, not citing specific sources. I don‚Äôt have concrete sources to back up those claims.‚Äù Perhaps someone else can write an explanation as to why this is the fix üòÖ\nNonetheless, this is a solution I may not have been able to come up with without AI. There is basically no chance I would‚Äôve read the Sortable docs carefully enough to notice the forceFallback parameter, especially because it wasn‚Äôt an option I was looking for.\nOn the other hand, AI alone couldn‚Äôt solve this either. Amp was only able to suggest a solution because I provided a prompt based on a hunch. Amusingly, once this is published, both humans and AI will be able to successfully use Sortable with Svelte and Tauri!\nTo be honest, my AI assistant told me to do that while debugging. It didn‚Äôt fix the immediate issue, so you probably don‚Äôt need to use @attach instead of $effect, but I‚Äôm not going back to rewrite it.¬†‚Ü©Ô∏é\nYes, that‚Äôs how I first tried to debug.¬†‚Ü©Ô∏é\n","wordCount":"1347","inLanguage":"en","datePublished":"2026-01-17T19:04:10-08:00","dateModified":"2026-01-17T19:04:10-08:00","author":{"@type":"Person","name":"Lyndon Shi"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://lynshi.github.io/posts/sortable_svelte_and_tauri/"},"publisher":{"@type":"Organization","name":"Nibbles and Bytes","logo":{"@type":"ImageObject","url":"https://lynshi.github.io/favicon/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://lynshi.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://lynshi.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://lynshi.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://lynshi.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://lynshi.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://lynshi.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://lynshi.github.io/posts/>Posts</a></div><h1 class=post-title>Sortable + Svelte + Tauri: Getting a sortable list right in a cross-platform app</h1><div class=post-description>AI might be better than a rubber duck</div><div class=post-meta><span title='2026-01-17 19:04:10 -0800 -0800'>January 17, 2026</span>&nbsp;¬∑&nbsp;7 min&nbsp;¬∑&nbsp;1347 words&nbsp;¬∑&nbsp;Lyndon Shi&nbsp;|&nbsp;<a href=https://github.com/lynshi/blog/tree/main/content/posts/sortable_svelte_and_tauri.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p><a href=https://github.com/SortableJS/Sortable>Sortable</a> is a very nice JavaScript library for making HTML lists sortable via drag-and-drop,
and it&rsquo;s got a very clear and easy to use API. Unfortunately, I spent a very long time struggling to integrate it into my app, so now
that I&rsquo;ve figured it out I might as well collect my findings into the blog post I wish I could have referenced instead.</p><p>It was quite hard to get working for two reasons. First, I&rsquo;m using <a href=https://svelte.dev/>Svelte</a> (version 5), which is a UI framework that very
much wants to solely manage the HTML. Second, I&rsquo;m using <a href=https://tauri.app/>Tauri</a> (version 2.0), a framework for building cross-platform
applications; this adds complexity beyond a web app.</p><p>Before getting started, I searched for resources that would tell
me exactly how to integrate all three things together. Sadly, there were none. The closest I got, and what I started with, was this <a href=https://dev.to/jdgamble555/svelte-5-and-sortablejs-5h6j>&ldquo;Svelte 5 and SortableJS&rdquo; blog post</a>. Unfortunately, there were still several issues to iron out thanks to the Tauri variable.
Ultimately, I ended up with an <a href=https://svelte.dev/docs/svelte/@attach>attachment-based</a> solution for an even more
~modern~ Svelte flavor<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><hr><h1 id=writing-the-attachment>Writing the attachment<a hidden class=anchor aria-hidden=true href=#writing-the-attachment>#</a></h1><p>The attachment itself is very simple. I created a function that takes <code>Sortable</code> options and returns an attachment that creates a <code>Sortable</code> with the provided options.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Sortable</span> <span class=nx>from</span> <span class=s2>&#34;sortablejs&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>type</span> <span class=p>{</span> <span class=nx>Attachment</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;svelte/attachments&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>sortableList</span> <span class=o>=</span> <span class=p>(</span><span class=nx>options</span><span class=o>:</span> <span class=nx>Sortable</span><span class=p>.</span><span class=nx>Options</span><span class=p>)</span><span class=o>:</span> <span class=nx>Attachment</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span><span class=nx>element</span><span class=o>:</span> <span class=nx>Element</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>sortable</span> <span class=o>=</span> <span class=nx>Sortable</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=nx>element</span> <span class=nx>as</span> <span class=nx>HTMLElement</span><span class=p>,</span> <span class=nx>options</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>sortable</span><span class=p>.</span><span class=nx>destroy</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><p>Similarily to the &ldquo;Svelte 5 and SortableJS&rdquo; blog post, I provided a helper function for reordering, though I chose to return <code>null</code> if the
order remained the same to avoid unnecessary updates.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>export</span> <span class=kd>function</span> <span class=nx>reorder</span><span class=o>&lt;</span><span class=nx>T</span><span class=o>&gt;</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=nx>array</span><span class=o>:</span> <span class=nx>T</span><span class=p>[],</span>
</span></span><span class=line><span class=cl>  <span class=nx>evt</span><span class=o>:</span> <span class=nx>Sortable</span><span class=p>.</span><span class=nx>SortableEvent</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span><span class=o>:</span> <span class=nx>T</span><span class=p>[]</span> <span class=o>|</span> <span class=kc>null</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>newArray</span> <span class=o>=</span> <span class=p>[...</span><span class=nx>$state</span><span class=p>.</span><span class=nx>snapshot</span><span class=p>(</span><span class=nx>array</span><span class=p>)]</span> <span class=nx>as</span> <span class=nx>T</span><span class=p>[];</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>oldIndex</span><span class=p>,</span> <span class=nx>newIndex</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>evt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>oldIndex</span> <span class=o>===</span> <span class=kc>undefined</span> <span class=o>||</span> <span class=nx>newIndex</span> <span class=o>===</span> <span class=kc>undefined</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>newIndex</span> <span class=o>===</span> <span class=nx>oldIndex</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>target</span> <span class=o>=</span> <span class=nx>newArray</span><span class=p>[</span><span class=nx>oldIndex</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>increment</span> <span class=o>=</span> <span class=nx>newIndex</span> <span class=o>&lt;</span> <span class=nx>oldIndex</span> <span class=o>?</span> <span class=o>-</span><span class=mi>1</span> <span class=o>:</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>k</span> <span class=o>=</span> <span class=nx>oldIndex</span><span class=p>;</span> <span class=nx>k</span> <span class=o>!==</span> <span class=nx>newIndex</span><span class=p>;</span> <span class=nx>k</span> <span class=o>+=</span> <span class=nx>increment</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>newArray</span><span class=p>[</span><span class=nx>k</span><span class=p>]</span> <span class=o>=</span> <span class=nx>newArray</span><span class=p>[</span><span class=nx>k</span> <span class=o>+</span> <span class=nx>increment</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>newArray</span><span class=p>[</span><span class=nx>newIndex</span><span class=p>]</span> <span class=o>=</span> <span class=nx>target</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>newArray</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The exact parameters in your <code>Sortable</code> options will vary, but the most important bit is to actually reorder your items!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>reorder</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;$lib/sortable.svelte&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>sortableOptions</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>onUpdate</span><span class=p>(</span><span class=nx>event</span><span class=o>:</span> <span class=nx>any</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>newList</span> <span class=o>=</span> <span class=nx>reorder</span><span class=p>(</span><span class=nx>groups</span><span class=p>,</span> <span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>newList</span> <span class=o>==</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Placeholder for updating the order of items.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>updateOrdering</span><span class=p>(</span><span class=nx>newList</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Then, we need to create the list and attach <code>sortableList</code>. You can generate list items dynamically with <code>@each</code>, but I found that
it&rsquo;s crucial to wrap the list in a <code>#key</code> block to recreate the list and <code>Sortable</code> every time the items are
reordered. If you do not do this, the item ordering will get out of sync between Svelte and Sortable and your list
will not display in the correct order.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-svelte data-lang=svelte><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kr>import</span> <span class=p>{</span> <span class=nx>sortableList</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;$lib/sortable.svelte&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// Your list of things
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>items</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>id</span><span class=o>:</span> <span class=s2>&#34;item-id&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>text</span><span class=o>:</span> <span class=s2>&#34;item-text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=k>#key</span> <span class=nx>items</span><span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>ul</span> <span class=p>{</span><span class=kd>@attach</span> <span class=nx>sortableList</span><span class=p>(</span><span class=nx>sortableOptions</span><span class=p>)}&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=k>#each</span> <span class=nx>items</span> <span class=kr>as</span> <span class=nx>item</span> <span class=p>(</span><span class=nx>item</span><span class=p>.</span><span class=nx>id</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;{</span><span class=nx>item</span><span class=p>.</span><span class=nx>text</span><span class=p>}&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=k>/each</span><span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=k>/key</span><span class=p>}</span>
</span></span></code></pre></div><hr><h1 id=making-drag-and-drop-work>Making drag and drop work<a hidden class=anchor aria-hidden=true href=#making-drag-and-drop-work>#</a></h1><p>From the Svelte side, everything looks great now. In fact, it will work perfectly if you throw it in a REPL<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>,
which is maddening because locally, in your Tauri app, you will not be able to drag any list items!</p><p>This is the first Tauri-introduced issue I encountered. The application window&rsquo;s drag-and-drop functionality was preventing the drag-and-drop event from registering in the webview. To avoid this, I had to add <code>dragDropEnabled: false</code> to my <code>tauri.conf.json</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;app&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;windows&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;dragDropEnabled&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Many thanks to <a href=https://www.reddit.com/r/tauri/comments/1hg85k7/using_vue_3_dragable_components_why_do_i_need_to/>this Reddit post</a> for
providing the hint I needed to find this fix!</p><hr><h1 id=ai-to-the-rescue>AI to the rescue<a hidden class=anchor aria-hidden=true href=#ai-to-the-rescue>#</a></h1><p>At this point, I had a working sortable list with one big problem. While I could drag one item to reorder it, I could not consistently
reorder items consecutively. The vast majority of the time, after moving one item I would have to click anywhere else on the page to be
able to move another item. If I did not click elsewhere, clicking a sortable item would not start a drag event, and I would end up
highlighting the text instead.</p><p>And yes, &ldquo;vast majority of the time&rdquo; means that on occassion I would be able to reorder items consecutively. So at first glance, this looks
like a race condition along the lines of the list being rendered before the sortable functionality is available. However, that hypothesis
is somewhat invalidated by the fact that when you are unable to reorder items consecutively, you cannot move the second item no matter how
long you wait after moving the first item.</p><p>In any event, I did the obvious thing which is to add a bunch of print statements and then try various things to ascertain the order of events.
When that failed, I had a few more hypotheses, but with my limited JavaScript knowledge I didn&rsquo;t know how to test them out.</p><p>Enter AI. At work, I&rsquo;m a pretty big fan of <a href=https://claude.com/product/claude-code>Claude Code</a> because it doesn&rsquo;t interrupt my stream of
thought by injecting slop when I hit <code>Tab</code> to, literally, insert spaces. However, it&rsquo;s a lot easier to use a tool when you don&rsquo;t have to pay
for it! Luckily, <a href=https://sourcegraph.com/>Sourcegraph</a> makes a similar terminal-based agent that has a free, ad-supported mode: <a href=https://sourcegraph.com/amp>Amp</a>. The ads are not bothersome at all and the agent worked quite well. With Amp, I was able to iterate quickly on my
hypotheses.</p><p>The most promising hypothesis I had was that dragging the first item hijacked pointer events in a way that required a &ldquo;reset&rdquo; (i.e. by
clicking elsewhere). I tried a few related fixes, such as injecting <code>pointerup</code> events after destroying the <code>Sortable</code>, to no avail. Along the
way, Amp suggested various code changes, one of which led to me printing <code>event.originalEvent</code> from the <code>event</code> received by <code>onUpdate</code>.</p><p>I noticed that the original event is actually a <code>DragEvent</code>. I&rsquo;m no frontend developer, but this seems a little
different from a pointer-based event. I responded to Amp with this:</p><blockquote><p>Dispatching pointerup doesn&rsquo;t help. Even though it&rsquo;s logged, I still need to click again to reactivate the sortable. I also noticed that event.originalEvent is a dragEvent with preventDefault: true.</p></blockquote><p>With that, it produced an interesting code block:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>sortable</span> <span class=o>=</span> <span class=nx>Sortable</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=nx>el</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span><span class=nx>options</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>forceFallback</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=c1>// Force pointer events instead of drag events
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span></code></pre></div><p>From <a href="https://github.com/SortableJS/Sortable?tab=readme-ov-file#forcefallback-option">Sortable docs</a>, <code>forceFallback</code> changes how drag-and-drop
works to be compatible with non-HTML5 browsers, even on HTML5 browsers. Setting this option completely fixes the issue!</p><p>Unfortunately, what I can&rsquo;t tell you is why this works, and after bashing my head on this for far too long I lack the inclination to do further
research. Amp reported that &ldquo;HTML5 Drag and Drop has known quirks, especially in Electron-like environments like Tauri&rdquo;, but when
pressed to cite sources it deflected with &ldquo;I was making educated guesses based on the symptoms you showed, not citing specific sources. I don&rsquo;t have concrete sources to back up those claims.&rdquo; Perhaps someone else can write an explanation as to why this is the fix üòÖ</p><p>Nonetheless, this is a solution I may not have been able to come up with without AI. There is basically no chance I would&rsquo;ve read the Sortable
docs carefully enough to notice the <code>forceFallback</code> parameter, especially because it wasn&rsquo;t an option I was looking for.</p><p>On the other hand, AI
alone couldn&rsquo;t solve this either. Amp was only able to suggest a solution because I provided a prompt based on a hunch. Amusingly, once this is published, both humans and AI will be able to successfully use Sortable with Svelte and Tauri!</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>To be honest, my AI assistant told me to do that while debugging. It didn&rsquo;t fix the immediate issue, so you probably don&rsquo;t <em>need</em> to use <code>@attach</code> instead of <code>$effect</code>, but I&rsquo;m not going back to rewrite it.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Yes, that&rsquo;s how I first tried to debug.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://lynshi.github.io/tags/tauri/>Tauri</a></li><li><a href=https://lynshi.github.io/tags/svelte/>Svelte</a></li></ul><nav class=paginav><a class=next href=https://lynshi.github.io/posts/gossip-glomers-3ac/><span class=title>Next ¬ª</span><br><span>Gossip Glomers 3 (a-c): Single-Node, Multi-Node, and Fault Tolerant Broadcast</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://lynshi.github.io/>Nibbles and Bytes</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>